# Source files
SET ( SOURCES
	rf.cpp
)


# Header files
SET( HEADERS
)

# Include the headers which are generated by uic and moc
# and include additional header
INCLUDE_DIRECTORIES(
	${CMAKE_SOURCE_DIR}/Base
	${CMAKE_SOURCE_DIR}/GEO
	${CMAKE_SOURCE_DIR}/FileIO
	${CMAKE_SOURCE_DIR}/MSH
	${CMAKE_SOURCE_DIR}/FEM
	${CMAKE_SOURCE_DIR}/MathLib
	${CMAKE_SOURCE_DIR}/OGSProject
)

IF (LIS)
  INCLUDE_DIRECTORIES(${LIS_INCLUDE_DIR})
ENDIF (LIS)


IF(OGS_FEM_PETSC OR OGS_FEM_PETSC_GEMS)
	INCLUDE_DIRECTORIES(${CMAKE_SOURCE_DIR}/MathLib/PETSC)
ENDIF()

if (Shapelib_FOUND)
	include_directories(${Shapelib_INCLUDE_DIR})
endif (Shapelib_FOUND)


IF (PARALLEL_USE_MPI)
	INCLUDE_DIRECTORIES(${MPI_INCLUDE_PATH})
ENDIF (PARALLEL_USE_MPI)


# Create the library
ADD_EXECUTABLE( ogs
	${SOURCES}
	${HEADERS}
)

TARGET_LINK_LIBRARIES( ogs
	FEM
	MSH
	GEO
	MathLib
	FileIO
	Base
	OGSProject
	${CMAKE_THREAD_LIBS_INIT}
)

IF (OGS_FEM_GEMS OR OGS_FEM_PETSC_GEMS)
	TARGET_LINK_LIBRARIES( ogs
		GEM
		${Boost_LIBRARIES}
		rt
	)
ENDIF ()

IF (OGS_FEM_PETSC_GEMS OR OGS_FEM_PETSC)
	TARGET_LINK_LIBRARIES( ogs
		${PETSC_LIBRARIES}
	)
ENDIF ()

####################
### Installation ###
####################

IF (OGS_PACKAGING)
	INSTALL (TARGETS ogs RUNTIME DESTINATION bin COMPONENT ogs)

	IF(MSVC)
		SET(OGS_EXE ${OGS_EXECUTABLE}.exe)
	ELSE(MSVC)
		SET(OGS_EXE ${OGS_EXECUTABLE})
	ENDIF(MSVC)

	INCLUDE(GetPrerequisites)
	if (EXISTS ${OGS_EXE})
		GET_PREREQUISITES(${OGS_EXE} OGS_GUI_DEPENDENCIES 1 1 "/usr/local/lib;/;${VTK_DIR}" "")
		MESSAGE (STATUS "ogs depends on:")
		FOREACH(DEPENDENCY ${OGS_DEPENDENCIES})
			IF(NOT ${DEPENDENCY} STREQUAL "not") # Some bug on Linux?
				message("${DEPENDENCY}")
				GP_RESOLVE_ITEM ("/" "${DEPENDENCY}" ${OGS_EXE} "/usr/local/lib;/;${VTK_DIR}" DEPENDENCY_PATH)
				SET (DEPENDENCY_PATHS ${DEPENDENCY_PATHS} ${DEPENDENCY_PATH})
			ENDIF()
		ENDFOREACH (DEPENDENCY IN ${OGS_DEPENDENCIES})
		INSTALL (FILES ${DEPENDENCY_PATHS} DESTINATION bin COMPONENT ogs)
	ENDIF (EXISTS ${OGS_EXE})
ENDIF (OGS_PACKAGING)
